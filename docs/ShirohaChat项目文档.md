# ShirohaChat 项目文档

## 摘要

本项目旨在开发一款面向**校园课程与小组协作**的桌面端即时通讯系统——ShirohaChat。不同于微信/QQ等通用IM工具,本系统围绕**「任务发布→讨论决策→任务拆分→文档产出→提交与反馈」**的协作链路进行结构化设计,提供更高效、更可控的学习协作体验。

系统核心创新在于将聊天工具升级为**协作链路工具**:通过消息任务标记、群文件自动聚合、代码片段高亮展示、会话摘要生成等功能,解决微信/QQ在校园协作场景中的上下文噪声、缺乏结构化能力、无法与课程体系结合等痛点。

在开发过程中,团队基于面向对象分析与设计方法(OOAD)和统一建模语言(UML)进行系统建模,采用客户端-服务器架构(C/S)实现消息实时传递。项目引入**非功能性需求(NFR)**管理、**协议契约设计**、**风险管理矩阵**与**量化性能指标**。系统实现端到端延迟 ≤ 200ms、消息送达率 ≥ 99.99%、单节点支持 ≥ 5000 并发连接,具备断线重连与离线补发机制,确保消息零丢失。

关键词:校园协作IM,协作链路模型,即时通讯,任务管理,文件聚合,代码高亮,消息可靠性,NFR

---

## 日期 / 修改 / 描述 / 作者



---

## 目录

* 摘要
* 第1章 立项

  * 1.1 项目起源与提案
  * 1.2 Business Case
* 第2章 愿景

  * 2.1 问题陈述
  * 2.2 涉众与用户
  * 2.3 关键涉众和用户的需要
  * 2.4 产品概述
  * 2.5 产品特性
  * 2.6 其他产品需求
* 第3章 用况建模

  * 3.1 术语表
  * 3.2 主要用况
  * 3.3 用况的完整描述
* 第4章 需求分析
* 第5章 架构设计
* 第6章 详细设计
* 后记
* 参考文献

---

# 第1章 立项

## 1.1 项目起源与提案

### 项目背景

在课程作业、小组项目、科研讨论等校园活动中,学生普遍使用微信/QQ作为主要沟通工具。然而,这些通用IM的「混合场景」特性导致协作效率低下、信息难以沉淀,存在三大核心问题:

**1. 混合场景带来上下文噪声**
* 课程群、小组群、生活群混在一个App中
* 重要任务/文件被垃圾信息淹没
* 专注度下降,文件无法有序组织

**2. 缺乏结构化协作能力**

微信是「纯聊天工具」,但课程协作需要:

| 链路环节 | 微信缺失能力 | 急需的能力 |
|---------|------------|----------|
| 任务拆分 | 无任务管理 | 消息任务标记、群任务视图 |
| 文件管理 | 不可分类、不可检索 | 群文件列表、按课程整理 |
| 代码片段讨论 | 不支持高亮 | Markdown + 代码高亮 |
| 历史追踪 | 只能靠滚动 | 搜索 + 会话摘要 |

**3. 微信不属于校园**
* 无法与课程/教师/学号体系结合
* 缺乏教学场景的权限管理(如教师公告模式)
* 不支持按学期/课程组织的分级导航

### 项目定位

> **"一款面向校园课程与小组协作的桌面端即时通讯系统,围绕『沟通—任务—文件—提交』的协作链路进行结构化设计,提供比微信/QQ更高效、更可控的学习协作体验。"**

### 协作链路模型(核心创新)

我们抽象出课堂协作的五步链路:

```
任务发布 → 讨论决策 → 任务拆分 → 文档产出 → 提交与反馈
```

ShirohaChat围绕这条链路进行功能设计:

| 协作链路 | 系统提供能力 |
|---------|------------|
| 任务发布 | 课程群、任务标记、置顶消息 |
| 讨论决策 | 群聊、代码高亮、引用回复 |
| 任务拆分 | 消息任务化、任务侧边栏 |
| 文档产出 | 文件传输、文件分类展示 |
| 提交与反馈 | 群文件列表、已完成标签 |

## 1.2 Business Case

### 项目目标

开发一款**高性能、高可用**的协作型即时通讯系统,采用MoSCoW方法进行功能优先级管理:

#### Must Have (MVP核心)
1. 账号体系(学号/邮箱注册登录)
2. 私聊/群聊(课程群/小组群)
3. 文本消息、代码消息(Markdown支持)
4. 文件传输(小文件)
5. Server-ACK机制
6. 离线消息拉取
7. 桌面客户端

#### Should Have
1. 搜索(按关键词/课程/群组)
2. 已读/未读状态
3. 群文件列表(自动聚合)
4. 消息任务标记(待办/已完成)

#### Could Have
1. AI会话总结服务
2. 课程→小组→会话分级导航
3. 断网/弱网重连动画
4. 教师角色的「课程公告」模式

#### Won't Have (本轮不做)
1. 视频/语音通话
2. 多端同步
3. 实时协作文档

### 预期收益

* **用户价值(学生)**:专注学习场景,减少上下文噪声,课程文件有序管理,代码讨论体验提升
* **用户价值(教师)**:结构化的课程公告渠道,任务发布与跟踪可视化,告别微信群的混乱
* **技术价值**:提供零丢失、低延迟(≤200ms)、稳定可靠的实时通讯服务
* **学习价值**:完整展示IM系统的工业级架构设计,包含NFR管理、协议设计、协作链路建模

### 约束与假设

| 维度   | 约束条件                              |
| ---- | --------------------------------- |


### 非功能性需求 (NFR)

| 维度   | 指标要求            | 验证方法              |
| ---- | --------------- | ----------------- |


---

# 第2章 愿景

## 2.1 问题陈述

### 问题一：通用IM缺乏协作链路支持

| 要素   | 描述                                                                  |
| ---- | ------------------------------------------------------------------- |
| 问题   | 微信/QQ是「纯聊天工具」,缺乏**任务拆分→文件管理→提交反馈**的协作链路支持,导致校园小组协作效率低下。 |
| 影响群体 | 高校学生(课程作业/小组项目)、教师(课程管理)、开发学习者。                                   |
| 后果   | 重要任务被聊天信息淹没、文件无法按课程分类、代码格式丢失、历史讨论难以追溯,严重影响协作效率与学习体验。          |
| 解决方案 | ShirohaChat围绕协作链路设计:消息任务化、群文件自动聚合、代码Markdown高亮、AI会话摘要,将聊天升级为结构化协作工具。 |

### 问题二：现有方案的技术局限

| 要素   | 描述                                                 |
| ---- | -------------------------------------------------- |
| 问题   | 主流闭源 IM 系统难以进行架构研究与二次开发，开源方案多为 Demo 级别，缺乏工业级设计。 |
| 影响群体 | 软件工程学习者、系统架构研究者。                                   |
| 后果   | 理论与实践脱节，无法深入理解 WebSocket、消息可靠性、分布式状态管理等核心技术。    |
| 解决方案 | ShirohaChat 开源完整架构设计（含 NFR、协议、风险管理），可作为学习与扩展基础。   |

---

## 2.2 涉众与用户

### 1. 涉众分析

| 涉众类型  | 代表       | 核心诉求                           | 优先级  |
| ----- | -------- | ------------------------------ | ---- |
| 项目团队  | 开发组/测试组  | 掌握工业级 IM 架构设计与实现能力              | 高    |
| 目标用户  | 高校学生     | 稳定、易用的协作沟通工具                   | 高    |
| 技术评审者 | 导师/面试官   | 系统展示专业性（架构、性能、文档）              | 高    |
| 潜在扩展者 | 开源社区开发者  | 清晰的代码结构与接口文档                   | 中    |

### 2. 用户画像(校园真实场景)

#### 张三 - 大二计算机专业学生

* **场景**:同时参与3门课程的小组作业,每门课都有微信群,群消息混杂生活聊天
* **痛点**:
  - 各种群组混乱,找不到老师发的作业文件
  - 代码片段在微信里无法正常展示,复制粘贴格式全乱
  - 不知道小组任务谁做了谁没做,只能口头确认
* **期望**:按课程组织的群聊、代码高亮显示、任务完成状态可视化

#### 李四 - 小组组长(软件工程专业)

* **场景**:负责协调5人团队完成大作业,需要分配任务、跟踪进度、收集文件
* **痛点**:
  - 进度分配全靠口头,无法追踪任务完成情况
  - 文件散落在聊天记录里,提交前要挨个找人要
  - 讨论记录太长,新成员加入后看不懂前因后果
* **期望**:消息任务标记、群文件自动聚合、AI生成会话摘要

#### 王老师 - 授课教师

* **场景**:管理3个教学班(共150人),需要发布课程通知、收集作业、答疑讨论
* **痛点**:
  - 微信群太多干扰,通知容易被刷屏淹没
  - 无法区分哪些学生已读通知、哪些未读
  - 学生提交的作业文件命名混乱,难以整理
* **期望**:教师角色的「课程公告」模式、已读状态统计、按课程组织的文件归档

---

## 2.3 关键涉众和用户的需要

| 涉众/用户 | 核心需求                            | 系统响应                        |
| ----- | ------------------------------- | --------------------------- |
| 学生用户  | 消息零丢失、文件稳定传输、代码格式保留             | Server-ACK + 离线补发 + 富文本支持  |
| 开发者   | 模块化架构、清晰接口文档、易于扩展               | API文档 + 分层设计 + 代码规范  |
| 评审者   | 展示系统专业性（性能指标、架构图、风险管理）          | NFR 量化 + 压测报告 + UML建模     |
| 运维者   | 一键部署、监控日志、故障恢复                  | 容器化部署 + 日志系统      |

---

## 2.4 产品概述

### 1. 产品定位陈述 (Elevator Pitch)

> **For** 高校学生、教师与小组协作团队  
> **Who** 在课程作业、小组项目中遭遇微信/QQ的混合场景噪声与结构化协作能力缺失  
> **The** ShirohaChat  
> **Is a** 面向校园协作的桌面端即时通讯系统  
> **That** 围绕「任务发布→讨论→拆分→产出→提交」的协作链路设计,提供消息任务化、群文件聚合、代码高亮、会话摘要等结构化能力  
> **Unlike** 微信(混合场景噪声、无任务管理、代码格式丢失)、QQ(界面复杂、广告干扰)、Discord(国内访问难)  
> **Our product** 将聊天工具升级为协作链路工具,同时保证消息可靠性≥99.99%、端到端延迟≤200ms,支持按课程分级组织与教师公告模式

### 2. 完整的产品概述

ShirohaChat 是一款**面向校园课程与小组协作的即时通讯系统**,采用前后端分离的 C/S 架构:

* **前端**:桌面客户端,提供课程→小组→会话的分级导航,支持Markdown代码高亮渲染
* **后端**:实时通讯服务,实现Server-ACK、离线消息队列、消息任务状态管理
* **数据层**:持久化存储用户/群组/消息数据,缓存在线状态与离线消息队列
* **核心特性**:
  - **协作链路支持**:消息→任务标记、群文件自动聚合、AI会话摘要
  - **代码友好**:Markdown渲染、代码语法高亮
  - **课程体系集成**:按学期/课程组织群聊,教师公告模式,学号认证
  - **消息可靠性**:Server-ACK机制、离线补发、消息零丢失(≥99.99%)
  - **高性能**:端到端延迟≤200ms,单节点支持≥5000并发连接

---

## 2.5 产品特性

| 优先级      | 功能模块             | 具体特性                             | 技术实现                    |
| -------- | ---------------- | -------------------------------- | ----------------------- |

---

## 2.6 其他产品需求

### 2.6.1 性能需求 (Performance)

| 指标       | 目标值       | 测试方法                         |
| -------- | --------- | ---------------------------- |


### 2.6.2 可靠性需求 (Reliability)

| 指标     | 目标值      | 实现方式                  |
| ------ | -------- | --------------------- |


### 2.6.3 兼容性需求 (Compatibility)


### 2.6.4 安全性需求 (Security)

| 威胁类型  | 防护措施                    |
| ----- | ----------------------- |


### 2.6.5 可维护性需求 (Maintainability)



### 2.6.6 可扩展性需求 (Scalability)


---

# 第3章 用况建模

请确定系统所有用况，写出简要描述，并选择一个用况进行完整描述。

## 3.1 术语表

| 术语             | 描述               |
| -------------- | ---------------- |
| 用户（User）       | 使用聊天系统的注册使用者     |
| 好友（Friend）     | 与用户建立双向连接关系的其他用户 |
| 群聊（Group Chat） | 多个用户组成的消息会话      |
| 消息（Message）    | 文本、图片、文件、表情数据    |
| Emoji          | 图形表情符号           |

---

## 3.2 ShirohaChat 的主要用况

---

## 3.3 主要用况的完整描述

---

# 第4章 需求分析

## 4.1 健壮性分析



## 4.2 交互建模

# 第5章 架构设计



---

# 第6章 详细设计



---

# 后记


---

# 参考文献



---



